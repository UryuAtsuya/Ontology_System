# 評価結果サマリー

本書類は、`Updated_Ontology.txt` をFew-shotプロンプトとして使用したGeminiモデル (gemini-2.5-flash) の性能評価結果をまとめたものです。

## 実験設定
- **モデル**: gemini-2.5-flash
- **クエリ**: "2020年以降に竣工した主要な高層建築物の耐震技術について教えてください。"
- **比較対象**:
    - **Few-shot**: プロンプトにオントロジーデータ（クラス、ルール、インスタンス）を含める。
    - **Zero-shot**: プロンプトにクエリのみを含める。
- **基準 (Reference)**: Few-shot生成の *最初の* 回答 (Run #0) を、そのバッチの指標計算における正解データ（Ground Truth）として使用。

## 指標サマリー

| 試行回数 (N) | 指標 | Few-shot (平均) | Zero-shot (平均) | 改善率 |
| :--- | :--- | :--- | :--- | :--- |
| **N=3** | ROUGE-L | 0.529 | 0.110 | +380% |
| | chrF | 0.685 | 0.181 | +278% |
| | TokenF1 | 0.536 | 0.110 | +387% |
| **N=10** | ROUGE-L | 0.266 | 0.147 | +81% |
| | chrF | 0.479 | 0.180 | +166% |
| | TokenF1 | 0.304 | 0.147 | +107% |
| **N=20** | ROUGE-L | 0.312 | 0.168 | +85% |
| | chrF | 0.529 | 0.173 | +205% |
| | TokenF1 | 0.400 | 0.171 | +133% |
| **N=30** | ROUGE-L | 0.172 | 0.086 | +100% |
| | chrF | 0.419 | 0.202 | +107% |
| | TokenF1 | 0.237 | 0.089 | +166% |

## Gold Standard 評価 (新手法)

AIの生成結果同士の比較ではなく、人間が作成した正解データ (`gold_standard.txt`) との比較結果です。

| 試行回数 (N) | 指標 | Few-shot (平均) | Zero-shot (平均) | 改善率 |
| :--- | :--- | :--- | :--- | :--- |
| **N=3** | chrF | 0.359 | 0.187 | +92% |
| **N=10** | chrF | 0.364 | 0.180 | +102% |
| **N=20** | chrF | 0.351 | 0.182 | +93% |

**考察:**
Gold Standardを用いた評価では、N=3, 10, 20 と試行回数を増やしてもスコア（chrF）は **0.35 ~ 0.36** の範囲で非常に安定しています。これは、Few-shotプロンプティングが、正解データに含まれる「具体的な建物名」や「耐震技術の有無」を安定して出力できていることを示しています。一方、Zero-shotは0.18前後で低迷しており、具体的な知識を引き出せていないことが明確です。

## 分析と特徴

### 1. Few-shotの一貫した優位性
すべてのサンプルサイズ (N=3 から N=30) において、**Few-shotプロンプティングはZero-shotを一貫して上回っています**。
- **chrF (文字n-gram F値)**: トークン化の誤差や些細なフォーマットの違いに対して堅牢なこの指標は、Few-shotにおいて一貫して **2倍から3.8倍高いスコア** を示しています。これは、オントロジーガイド付きの回答が、基準回答と文字レベルの内容（具体的な建物名、専門用語）をより多く共有していることを示しています。
- **ハルシネーションの削減**: Zero-shotの回答は、具体的な建物を正しく挙げられず、「免震構造」や「制震構造」の一般的な説明に終始する傾向があります。一方、Few-shotの回答は、オントロジーに基づいて「Torch Tower」や「麻布台ヒルズ森JPタワー」などの建物を正確に列挙しています。

### 2. 基準フォーマットへの感度
**ROUGE-L** や **TokenF1** の絶対値は、実行回数によって大きく変動しています（例：N=3 と N=30 の比較）。
- **原因**: 評価スクリプトは、*最初に生成された回答 (Run #0)* を基準として使用しています。
- **観察**:
    - **N=3** では、Run #0 が後続の実行と非常に似たフォーマット（例：箇条書き）であったため、高い重複スコアとなりました。
    - **N=30** では、Run #0 が番号付きリスト形式 (`1. JPタワー...`) を使用していたのに対し、後続の多くの実行は箇条書き (`* Torch Tower...`) や異なる順序を使用していました。この構造的な不一致により、内容は正しくてもROUGEのような「完全一致」タイプの指標が低下しました。
- **示唆**: 単語の順序やリストの形式よりも文字の内容に焦点を当てているため、この特定の設定では `chrF` が最も信頼できる指標です。

### 3. 統計的安定性
- **N=10, 20, 30** では、`chrF` の傾向が収束しています（Few-shotは 0.42 - 0.53 前後、Zero-shotは 0.17 - 0.20 前後で推移）。
- **N=30** は、単一の異常値の影響を最小限に抑えられるため、研究論文用として最も統計的に堅牢なデータセットを提供します。

## 研究論文に向けた結論
- **使用データ**: 統計的な堅牢性から、**N=30** のデータセットを推奨します。
- **強調すべき指標**: フォーマットの変動にかかわらず、正しい用語やエンティティの検索を最もよく捉えている **chrF** を、精度の主要な指標として焦点を当ててください。
- **定性的議論**: Few-shotの結果における建物名のユニークトークン数の多さが証明しているように、Few-shotプロンプティングによってモデルが（Zero-shotでは完全に失敗している）*具体的なインスタンスデータ* を用いて回答できるようになることを強調してください。
